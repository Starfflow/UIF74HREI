# ИНЦИДЕНТ: ШИФРОВАЛЬЩИК

------------

  
### ПОДГОТОВКА

<details>
  <summary>Развернуть</summary>
  
__Проверка коммуникаций:__

- Проверить четкое определение ролей и обязанностей технического персонала и других отделов во время реагирования на кибер-инциденты. Убедиться, что каждый участник понимает свои задачи и действия в случае возникновения инцидента.  
- Определить критерии эскалации инцидента на уровень руководства. Установить четкий процесс передачи информации и ответственности при эскалации.  
- Создать готовые формы сообщений об инциденте для пользователей, CERT и иных заинтересованных лиц  

**Должен существовать и быть доступным список активов и их владельцев для следующих категорий:**

- Активы клиентов: 
  - Владельцы
  - Контактные лица
- Активы компании (включая все филиалы и подразделения): 
  - Владельцы
  - Контактные лица
  - Администраторы
- Инвентаризация инфраструктуры: 
  - Конечные точки (компьютеры, ноутбуки, мобильные устройства)
  - Серверы
  - Сетевое оборудование
  - Системы безопасности, СЗИ
  - Диапазоны сети: 
    - Публичная
    - Частная
    - VPN / Внеполосные данные
  - Сотрудники  
  -  Партнеры  
  -  Клиенты  

__Обзор последних кибер-инцидентов и их результатов:__

-	Проанализировать произошедшие инциденты безопасности для выявления слабых мест и улучшения реагирования.
-	Извлечь уроки из прошлых инцидентов для более эффективного реагирования в будущем.
Обзор угроз, новых рисков и уязвимостей: 
-	Изучить актуальные угрозы в киберпространстве, нацеленные на вашу организацию, поставщиков и отрасль.
-	Анализировать общие тенденции и новые типы атак, чтобы быть готовым к ним.
-	Внедрить процессы threat intelligence 

**Менеджмент рисков:**

- Определить возможность организации платить выкуп за расшифрование данных. Оценить максимально допустимую сумму выкупа и возможность реализовывать переводы через криптовалюту.
- Обрести ключи расшифрования для разных видов программ-вымогателей.
- Убедиться в страховом покрытии в сфере компьютерных инцидентов

**Обеспечение доступа к необходимой документации и информации, в том числе вне рабочего времени, к: **
- Плану реагирования на кибер-инциденты
- Схеме сетевой архитектуры 
- Схеме потоков данных 
- Ключевым документам, необходимым для реагирования на инциденты.

**Проведение регулярных кампаний для информирования сотрудников о рисках информационной безопасности, включая:**

- Фишинговые атаки / вредоносные электронные письма: 
	- Обучить сотрудников распознавать признаки фишинговых писем и избегать нажатия на подозрительные ссылки или вложения.
	- Предоставить инструкции о том, как безопасно обрабатывать электронную почту.
	- Провести симуляцию фишинговой атаки.
- Программы-вымогатели: 
	- Объяснить сотрудникам, что такое программы-вымогатели и как они могут нанести ущерб организации.
	- Предоставить рекомендации по предотвращению заражения вредоносным ПО и действий в случае атаки.
	- Провести симуляцию атаки вымогателя.
- Возможность сообщения о подозрении на киберинцидент: 
	- Установить четкий процесс и каналы связи для сообщения о подозрительной активности, связанной с безопасностью.
	- Поощрять сотрудников сообщать о любых инцидентах, не опасаясь негативных последствий.

**Обеспечение регулярного обучения по безопасности для сотрудников, управляющих персональными, конфиденциальными или критическими данными и системами:**

- Обязательное прохождение специализированных тренингов по безопасности для сотрудников, которые работают с чувствительной информацией.
- Регулярное обновление знаний и навыков сотрудников в области защиты данных и реагирования на угрозы.
- Проводить тренировку отдела безопасности в части реагирования (например, киберучения)

**Подготовка инфраструктуры:**

- Пропатчить уязвимости информационных активов
- Провести плановые проверки средств управления и СЗИ 
- Провести плановые проверки наличия и состояния резервных копий (+ что резервные копии не заражены ВПО).
- Проверить расшаренные директории на наличие открытых привилегий
- Обеспечить поддержку обновлений EDR/AV приложений
- Сегментировать сеть и логировать траффик между сегментами. Убедиться в возможности изоляции сегментов, регионов, партнеров или Интернета.
- Внедрить deception-систему.
- Уделить внимание анти-фишинговым решениям и мониторингу появления процессов PS, CMD, WMI, MSHTA и тд.
- Настроить SIEM-систему для выявления подозрительной активности и автоматического оповещения о потенциальных угрозах. Определить четкие критерии, по которым система будет генерировать оповещения.
- Автоматизировать процессы реагирования в SOAR/IRP
- Включить функцию «Показывать расширения файлов» в настройках на пользовательских хостах.

</details>


  
## ВЫЯВЛЕНИЕ

<details>
<summary> Развернуть </summary>

**Анализ каналов выявления (автоматических и мануальных):**

- Оповещения с AV/EDR, SIEM
- Обнаружения с почтовых фильтров (сообщения с подозрительными вложениями)
- Необычная активность на ПК, серверах или телефонах
- Сообщения от конечных пользователей (как правило, об искаженных или недоступных файлах)
- Появление необычных/потенциально вредоносных файловых расширений
- Необычный DNS-трафик
- Высокая скорость переименования/изменения файлов
- Скачки CPU в системах обмена файлами
- Необычные исполняемые бинарные файлы в пользовательской среде
- Аномальные сетевые соединения на хостах, сетевые подключения к известным CnC адресам
- Фаервол запрещает доступ к проверенным точкам обмена файлами
- Информация от deception-систем
- Использование TOR или I2P, истории поиска

**Срочное информирование о киберинциденте:**

- Проверить сообщения от СЗИ на факт ложного срабатывания (false positive)
- При подтверждении вредоносной активности шифровальщика, сообщить о ней через службу поддержки (Service Desk).
  - Если заявки еще не существует, создать новую с минимальной информацией.
- Подумать о том, чтобы уведомить и привлечь CERT к расследованию
- В установленные сроки уведомить ГосСОПКА/НКЦКИ/ФСБ при необходимости

**Определить, произошла ли утечка данных, и если да, то:**

- Обратиться к плейбуку по реагированию на утечки данных.
- Рассмотреть, целесообразно ли на данном этапе сообщать в РКН о подозреваемом или подтвержденном несанкционированном доступе к любым персональным данным.

**Классификация инцидента:**

- Оценить следующие данные о шифровальщике:
	- Всплывающие окна при открытии шифрованного файла, текстовые или html-файлы (как правило, всплывают сами после зашифрования)
	- Email для связи с атакующим
	- Язык всплывшего сообщения
	- Метод оплаты и реквизиты, валюта
	- Страница «поддержки»
	- Расширение/тип шифрованных файлов (.crypt, .cry, .locked, .abc., .xyz и т.д.)
	- Размещение зашифрованных файлов
	- Иконка зашифрованных файлов
- Загрузить зашифрованный файл в сервисы, например, Crypto Sheriff, ID Ransomware, ProvenData, noransom.kaspersky.com, nomoreransom.org. Там возможно определить тип (семейство) шифровальщика и даже получить приватные ключи.
- На основе имеющейся информации о потере данных и типах инцидентов классифицировать киберинцидент.

> [!NOTE]\
> This is a note. (hard line break `\`)

**Подготовка к этапу анализа:**

- Мобилизовать группу реагирования на инциденты кибербезопасности (CIRT) для первоначального расследования кибер-инцидента. Определить вероятность широкомасштабного заражения программой-вымогателем.
- Собрать первоначальные данные об инциденте, включая как минимум следующее:
	- Тип кибер-инцидента;
	- Куда сообщили о кибер-инциденте;
	- Места появления сообщений о вымогательстве (физические и логические);
	- Количество пострадавших активов в организации (на начальном этапе) и увеличивается ли оно;
	- Идентификация вредоносного электронного письма, если оно есть;
	- Дополнительные отчеты, связанные с пострадавшими активами, включая журналы антивируса, системные журналы событий и журналы сетевого мониторинга;
	- Предварительная оценка воздействия на бизнес, критичность;
	- Любые текущие действия, предпринимаемые для устранения инцидента.
- Обеспечить сохранность артефактов, включая копии подозреваемого вредоносного ПО и криминалистические копии пострадавших систем для дальнейшего анализа.
- Оценить приоритет инцидента на основе первоначального расследования
- Оповестить руководство в соответствии с планом эскалации

</details>
