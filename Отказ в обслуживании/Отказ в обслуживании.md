# ИНЦИДЕНТ: ОТКАЗ В ОБСЛУЖИВАНИИ


<details>
  <summary>Основные сведения об инциденте (нажмите, чтобы развернуть)</summary>




</details>




---

# Этапы реагирования на инцидент

<details>
  <summary>Развернуть</summary>




## ПОДГОТОВКА

<details>
  <summary>Развернуть</summary>

**Проверка коммуникаций:**

- Проверить четкое определение ролей и обязанностей технического персонала и других отделов во время реагирования на кибер-инциденты. Убедиться, что каждый участник понимает свои задачи и действия в случае возникновения инцидента.
- Определить критерии эскалации инцидента на уровень руководства. Установить четкий процесс передачи информации и ответственности при эскалации.
- Создать готовые формы сообщений об инциденте для пользователей, CERT и иных заинтересованных лиц
	- Подготовить внутренний и внешний шаблоны для общения по поводу инцидентов DDoS-атак
	- Определить каналы, где будет размещена эта информация

**Должен существовать и быть доступным список активов и их владельцев для следующих категорий:**

- Активы клиентов:
	- Владельцы
	- Контактные лица
- Активы компании (включая все филиалы и подразделения): 
	- Владельцы
	- Контактные лица
	- Администраторы
- Инвентаризация инфраструктуры: 
	- Конечные точки (компьютеры, ноутбуки, мобильные устройства)
	- Серверы
	- Сетевое оборудование
	- Системы безопасности, СЗИ
	- Диапазоны сети: 
		- Публичная
		- Частная
		- VPN / Внеполосные данные
	- Сотрудники
	- Партнеры
	- Клиенты
- Создать белый список IP-адресов и протоколов, которые необходимо разрешить при приоритизации трафика во время атаки

**Обзор последних кибер-инцидентов и их результатов:**

- Проанализировать произошедшие инциденты безопасности для выявления слабых мест и улучшения реагирования.
- Извлечь уроки из прошлых инцидентов для более эффективного реагирования в будущем.

**Обзор угроз, новых рисков и уязвимостей:**

- Изучить актуальные угрозы в киберпространстве, нацеленные на вашу организацию, поставщиков и отрасль.
- Анализировать общие тенденции и новые типы атак, чтобы быть готовым к ним.
- Внедрить процессы threat intelligence

**Обеспечение доступа к необходимой документации и информации, в том числе вне рабочего времени, к:**

- Плану реагирования на кибер-инциденты
- Схеме сетевой архитектуры
- Схеме потоков данных
- Ключевым документам, необходимым для реагирования на инциденты

**Проведение регулярных кампаний для информирования сотрудников о рисках информационной безопасности**

**Подготовка инфраструктуры:**

- Пропатчить уязвимости информационных активов
- Провести плановые проверки средств управления и СЗИ
- Провести плановые проверки наличия и состояния резервных копий (+ что резервные копии не заражены ВПО).
- Обеспечить поддержку обновлений EDR/AV приложений
- Сегментировать сеть и логировать трафик между сегментами. Убедиться в возможности изоляции сегментов сети
- Внедрить deception-систему
- Настроить SIEM-систему для выявления подозрительной активности и автоматического оповещения о потенциальных угрозах. Определить четкие критерии, по которым система будет генерировать оповещения.
- Автоматизировать процессы реагирования в SOAR/IRP

**Разработка плана аварийного восстановления/плана обеспечения непрерывности бизнеса, уделяя особое внимание критически важным активам и тому, как на них повлияет сетевая DoS-атака.**

**Следите за:**

- Необычными потоками данных в сети. Сюда входят процессы, использующие сеть, которые обычно не требуют сетевого взаимодействия или обмениваются данными по сети впервые. 
- Журналами, сообщениями и другие показателями работоспособности системы (из хостовых СЗИ). Регулярно проверять журналы брандмауэра, IDS, IPS и SIEM на наличие необычной активности.
- Другими признаками DoS-атаки, такие как чрезмерное потребление ресурсов или низкая производительность сети/ресурсов.
- Невозможностью доступа к определенному веб-сервису
- Внезапными проблемами с подключением между устройствами в одной сети

**Поддержка интернет-провайдера (ISP):**

- Свяжитесь с вашим ISP, чтобы узнать о предлагаемых им услугах по смягчению DDoS-атак (бесплатных и платных). Подключить услуги поставщика средств защиты от DDoS-атак.
- По возможности обеспечьте резервное интернет-соединение
- Установите методы контакта с вашим ISP и правоохранительными органами. Убедитесь, что у вас есть возможность использовать резервный канал связи (например, сотовая связь).
- Убедитесь, что у вашего ISP и службы по смягчению DDoS-атак есть круглосуточная телефонная поддержка.
- Если бизнес-процессы критически зависят от интернета, подумайте о приобретении специализированных продуктов или услуг по смягчению DDoS-атак.

**Сетевая инфраструктура:**

- Разработать надежную сетевую инфраструктуру без единой точки отказа (узел системы, отказ которого приводит к её неработоспособности) или слабых мест
- Развернуть Web Application Firewall для защиты от DDoS-атак на прикладном уровне
- Распределить DNS-серверы и другие критические службы (SMTP и т. д.) по разным автономным системам (АС).
- Укрепить конфигурацию операционных систем, компонентов приложений и сети которые могут подвергнуться DDoS-атаке.
- Определить базовый уровень производительности вашей текущей инфраструктуры, чтобы быстрее и точнее обнаружить атаку.
- Подтвердить настройки времени жизни (TTL) DNS для систем, которые могут подвергнуться атаке. При необходимости понизьте TTL, чтобы облегчить перенаправление DNS, если исходные IP-адреса подвергнутся атаке. Оптимальное значение TTL - 600 секунд.
- В зависимости от критичности вероятного инцидента, рассмотреть возможности резервного копирования, которое можно активировать в случае атаки.
- По возможности создать сигнатуру NIDS для фокусировки на различении легитимного и вредоносного трафика.
- Использование оборудования для отражения DDoS-атак. DefensePro (Radware), SecureSphere (Imperva), Периметр (МФИ Софт), Arbor Peakflow, Riorey, Impletec iCore и т.д.

**Оценка рисков:**

- Консультируйтесь с бизнес-подразделениями, чтобы оценить последствия для бизнеса (например, финансовые потери) вероятных сценариев DDoS-атак.

Этап подготовки считается наиболее важным элементом успешного реагирования на инцидент DDoS-атаки

</details>

## ВЫЯВЛЕНИЕ

<details>
  <summary>Развернуть</summary>
  
**Анализ каналов выявления:**

- Проверить отчеты внедрённой службы анти-DDoS и иных СЗИ:
	- Проанализировать логическую последовательность DDoS-атаки и определить компоненты инфраструктуры, на которые она повлияла.
- Просмотреть файлы нагрузки и журналы серверов, маршрутизаторов, брандмауэров, приложений и других частей пораженной инфраструктуры.

Для анализа трафика можно использовать инструменты сетевого анализа: Tcpdump, Tshark, Snort, Netflow, Ntop, MRTG, Cacti, Nagios и т.д.

- Общие признаки DDoS-атак включают:
	- Внезапный поток запросов к определенной конечной точке или веб-странице
	- Внезапный всплеск трафика, происходящий с регулярными интервалами или в необычные временные рамки с одного IP-адреса или нескольких IP-адресов
	- Необычно медленная работа сети или Wi-Fi
	- Медленная работа приложения
	- Длительная невозможность доступа к веб-сайтам (ошибки 502, 503, 504) или системным файлам
	- Высокая загрузка процессора и памяти
	- Частые отключения от беспроводного или проводного интернет-соединения
	- Увеличение объема спам-писем
	- Увеличивается количество запросов к базам данных или к другим внутренним сервисам

**Подтверждение атаки на систему:**

- Подтвердить, что система подвергается атаке, а не просто испытывает высокую нагрузку. Проанализировать, являетесь ли вы целью атаки или косвенной жертвой.
- Если существуют показатели нормальной нагрузки на систему, их можно сравнить с текущим наблюдаемым трафиком. 
- Подтвердить, что подозрительный трафик действительно является DDoS-атакой, проверив системные журналы и данные сетевого трафика.
	- Убедитесь, что потеря работоспособности не вызвана другими факторами, такими как внутренний сбой сервера, перебоем интернет-соединения или сбоем облачного сервиса.
	- Проверьте, ожидает ли организация большого объема трафика (например, запуск новой услуги или продукта, временные акции и т.д.).
	- При этом необходимо учитывать изменения нагрузки в зависимости от времени, поскольку некоторые системы используются только в определенный период (дня/месяца/года).
- Определите, какие аспекты DDoS-трафика отличают его от легитимного трафика:
	- Исходные IP-адреса, АС и т.д.
	- Порты назначения
	- URL-адреса
	- Флаги протоколов

**Минимум, который необходимо выяснить:**

- Какие системы/приложения/службы/иные компоненты подвергаются атаке?
- Какое влияние это оказывает на них и пропускную способность каналов? Существует ли какая-либо закономерность в процессе атаки?
- Ухудшается ли ситуация, распространяется ли атака или она по-прежнему ограничивается теми же системами/приложениями?
- Распространилась ли атака на какие-либо общие компоненты, или она может распространиться на них? (Например, компоненты инфраструктуры, службы каталогов и т.д.)
- Затрагивает ли атака внутренние корпоративные системы и/или распространилась ли она на корпоративную сеть?
- Поступили ли какие-либо звонки в службу поддержки от клиентов?
- Похоже ли это на отвлекающий маневр перед более фундаментальной атакой, которая может привести к утечке данных из других корпоративных систем или систем, подвергшихся DoS-атаке?
- Получены ли какие-либо сообщения от предполагаемого злоумышленника? (Через социальные сети, электронную почту, телефонный звонок и т.д.)

**Дополнительная информация:**

- Хронология обнаружения атаки
- Подтвердите, доступны ли системы изнутри и снаружи периметра
- Уточните, отключены ли системы или они работают с пониженной производительностью
- Подробности типа атаки (если известны на данном этапе)

**Срочное информирование о киберинциденте:**

- Проверить сообщения от СЗИ на факт ложного срабатывания (false positive)
- При подтверждении DoS-атаки, сообщить о ней через службу поддержки (Service Desk).
	- Если заявки еще не существует, создать новую с минимальной информацией.
- Подумать о том, чтобы уведомить и привлечь CERT к расследованию
- В установленные сроки уведомить ГосСОПКА/НКЦКИ/ФСБ при необходимости

**Подготовка к этапу анализа:**

- Мобилизовать группу реагирования на инциденты кибербезопасности (CIRT) для первоначального расследования кибер-инцидента.
- Подключить к расследованию специалистов по сетевой инфраструктуре
- Собрать первоначальные данные об инциденте, включая как минимум следующее:
	- Тип кибер-инцидента;
	- Куда сообщили о кибер-инциденте;
	- Места появления сообщений об отказе в обслуживании (физические и логические);
	- Количество пострадавших активов в организации (на начальном этапе) и увеличивается ли оно;
	- Дополнительные отчеты, связанные с пострадавшими активами, включая журналы антивируса, системные журналы событий и журналы сетевого мониторинга;
	- Предварительная оценка воздействия на бизнес, критичность;
	- Любые текущие действия, предпринимаемые для устранения инцидента.
- Оповестить руководство в соответствии с планом эскалации

</details>


## АНАЛИЗ

<details>
  <summary>Развернуть</summary>
  
**Первоначальный анализ:**

- Подключить к расследованию инцидента сетевых инженеров, обладающими диагностическими инструментами/средствами (такими как Netflow), для сбора и анализа поступающих пакетов на пораженные системы, чтобы определить:
	- отправляющий IP-адрес;
	- порт;
	- протокол;
	- агент пользователя;
	- содержимое пакета;
	- флаги пакетов.

Имейте в виду, что DoS-атака может быть отвлекающим маневром, скрывающим более сложную и целевую атаку.

**Выяснить, поступало ли компании требование о вымогательстве перед атакой:**

- Проверить факт наличия соответствующих электронных писем
- Некоторые злоумышленники отправляют требования о вымогательстве напрямую на электронные адреса, указанные в записях Whois целевого веб-сайта
	- Ищите заявления об атаке в медиа пространстве
	- Выясните, мог ли кто-нибудь быть заинтересован в том, чтобы угрожать вашей компании:
		- Конкуренты
		- Группы с идеологической мотивацией (хактивисты)
		- Бывшие сотрудники
- Применяя технические и правовые меры, нужно как можно активнее воздействовать на источник и организатора DDoS-атаки. В настоящее время даже существуют специальные организации, которые помогают найти не только человека, который провел атаку, но даже и самого организатора.
- В случае попытки вымогательства попытайтесь выиграть время у злоумышленника. Например, объясните, что вам нужно больше времени, чтобы получить одобрение руководства в своих действиях. 
- Если организаторы ddos-атаки будут выявлены, рассмотрите возможность обратиться в правоохранительные органы. Это должно быть сделано по рекомендации юридической службы и руководства компании.

**Сбор доказательств:**

Сбор доказательств позволит понять природу атаки, включая тип DDoS-атаки, источник трафика атаки, влияние атаки и типы атакуемых систем. Проанализируйте данные, чтобы определить первопричину атаки и выявить любые уязвимости, которые могли быть использованы.

**Проверить:**

- Журналы сетевого трафика с брандмауэров, маршрутизаторов, коммутаторов и других сетевых устройств для определения источника и типа трафика, задействованного в атаке.
- Системные журналы с серверов и других систем для выявления любой необычной активности или проблем с производительностью.
- Данные сетевого потока (захват пакетов) для анализа объема, адресации и содержимого сетевого трафика, а также для выявления любых закономерностей или других аномалий.
- Собрать полученные захваты сетевого трафика (.pcap), журналы и любые другие доступные данные для дальнейшего анализа и сбора доказательств. Архивируйте артефакты сканирования, такие как IP-адреса, записи user-agent и запросы.

**Категоризация атаки**

- Обратитесь к своему интернет-провайдеру, чтобы определить, есть ли сбои на его стороне или его сеть является целью атаки, а вы являетесь косвенной жертвой.
- Проанализировать природу и характеристики DoS-атаки, включая векторы атаки, источники трафика и шаблон атаки. Определить, нацелена ли DoS-атака на конкретные уязвимости, протоколы или ресурсы.
- Определить системы (напр., серверы, БД…), службы или приложения, испытывающие снижение производительности или сбои.
- На основании собранных доказательств определите тип DoS-атаки
	- Получите больше информации о вредоносных пакетах (уровень OSI, номер порта назначения, протокол связи и т.д.). Пакеты при атаке типа "отказ в обслуживании" часто имеют общую сигнатуру, поэтому полезно ознакомиться с наиболее распространенными на данный момент видами DoS-атак.
- Проведите категоризацию кибер-инцидента, чтобы подтвердить тип кибер-инцидента как DoS-атаку, и оцените приоритетность инцидента на основе первоначального расследования.

**Взаимодействие с внутренними и внешними участниками:**

- Свяжитесь с внутренними подразделениями, чтобы узнать об их осведомленности об атаке.
- Обратитесь к своему интернет-провайдеру (ISP) за помощью. Конкретизируйте данные об атаке:
	- Задействованные сетевые блоки
	- Исходные IP-адреса
	- Протоколы
- Провайдер может ввести необходимые ограничения для предотвращения дальнейшего нелегитимного трафика (этап "сдерживание и устранение")
  
</details>

## СДЕРЖИВАНИЕ И УСТРАНЕНИЕ

<details>
  <summary>Развернуть</summary>
Большинство технических мер по устранению проблемы могут быть реализованы вашим интернет-провайдером (ISP) и/или поставщиком услуг защиты от DDoS-атак.

**Связь с провайдером:**

- Если слабое место находится на стороне интернет-провайдера или службы защиты от DDoS-атак, предпринять эффективные действия могут только они. В таком случае тесно сотрудничайте с вашим интернет-провайдером и/или поставщиком услуг защиты от DDoS-атак и убедитесь, что ваш обмен информацией достаточно эффективен.
- Сетевая группа должна связаться с интернет-провайдером и обсудить, какую фильтрацию они могут обеспечить. Поскольку DoS-атака, как правило, влияет на всех кто использует одно и то же оборудование, интернет-провайдер может включить в договор возможность разорвать соединения компании для защиты других клиентов от атаки. Это повлияет на все службы компании, использующие данное сетевое соединение. 
- Если атака выводит из строя службы, можно предпринять шаги для восстановления хотя бы некоторого уровня обслуживания, например, обратиться к интернет-провайдеру (ISP) с просьбой отбросить весь трафик, направленный на пораженную службу/приложение. В абсолютном крайнем случае, если критически важно поддерживать внутренние службы, весь трафик от интернет-провайдера может быть заблокирован.
- Проверьте, могут ли интернет-провайдеры или поставщики облачных услуг предоставить организации какую-либо форму защиты от DDoS-атак:
	- Очистка трафика / Clean pipe Очистка трафика / стокхол / чистый канал
	- Sinkholing (блокировка известных вредоносных IP-адресов)
	- Фильтрация (по возможности на уровне Tier1 или 2)
	- Балансировка/разделение/переключение общедоступных IP-адресов
	- Нулевая маршрутизация (использовать в крайнем случае)

**Самостоятельное сдерживание:**

Прим.: фильтрация может быть двух видов: использование межсетевых экранов и списков ACL

- По возможности исправьте уязвимости активов, послужившие вектором для DoS-атаки. Если слабым местом является определенная функция приложения, временно отключите эту функцию. Определите, использует ли DoS-атака конкретную службу (например, ICMP) или атакует определенный порт. Отключите эту службу или закройте порт, если они не критичны для работы целевой системы.
- Попытайтесь ограничить или заблокировать трафик DoS с помощью маршрутизатора, межсетевого экрана, балансировщика нагрузки, иного специализированного устройства/ПО. Получите IP-адреса входящих DDoS-пакетов и реализуйте контроль доступа для блокировки этих IP-адресов. Внедрите ограничение скорости, чтобы ограничить количество пакетов, которые могут быть отправлены с одного IP-адреса.
- Завершите нежелательные соединения или процессы на серверах и маршрутизаторах и настройте их параметры TCP/IP
- По возможности переключитесь на альтернативные сайты или сети с помощью DNS или другого механизма. Настройте альтернативный канал связи между вами и вашими пользователями/клиентами (например, веб-сервер, почтовый сервер и т. д.).
- По возможности перенаправляйте трафик с исходных IP-адресов через сервис фильтрации трафика с помощью DNS или изменений маршрутизации (например, маршрутизация с использованием sinkhole). Настройте фильтры исходящего трафика для блокировки трафика, который ваши системы могут отправлять в ответ на вредоносные запросы. Перенаправьте трафик и переключите операции на альтернативные серверы, если таковые имеются.
- Установите строгие конфигурации «TCP keepalive» и «максимальное количество подключений» на всех устройствах сетевого периметра.
- Настройте брандмауэры (firewalls) для блокировки, как минимум, входящего трафика с IP-адресов, которые:
	- Зарезервированы (0/8);
	- Loopback (127.0.0.0/8);
	- Частный (RFC 1918 блокирует 10.0.0.0/8, 172.16.0.0/12, и 192.168.0.0/16);
	- Неопределенные DHCP-клиенты;
	- TEST-NET-1/2/3 (192.0.2.0/24, 198.51.100.0/24, и 203.0.113.0/24);
	- Рассылка (224.0.0.0/4);

Если атака привела к серьезным последствиям, вам может понадобиться сообщить об инциденте регулирующим органам.


</details>

## ВОССТАНОВЛЕНИЕ

<details>
  <summary>Развернуть</summary>
  
**Оценка завершения DDoS-атаки:**

- Убедитесь, что все затронутые сервисы снова доступны. 
- Убедитесь, что производительность вашей инфраструктуры вернулась к базовому уровню.

**Откат мер по смягчению атаки:**

- Переключите трафик обратно на вашу исходную сеть. 
- Перезапустите остановленные службы.

Убедитесь, что действия по восстановлению согласованы с сетевыми командами. Восстановление служб может иметь непредвиденные побочные эффекты.

</details>

## ПОСТ-ИНЦИДЕНТ

<details>
  <summary>Развернуть</summary>
  
- Подготовить отчет об инциденте, включая все детали и действия, предпринятые для его устранения.
- Завершить процессы выявления уроков и управления проблемами с предыдущих этапов.
- Обеспечить соответствующие внутренние и внешние коммуникации об инциденте
- Внедрить в СЗИ полученные сигнатуры данной атаки; обновить правила детектирования в SIEM, Анти-спам (фильтры), EDR (готовые TTP или ручные настройки) и иных решениях
- Пересмотреть харденинг инфраструктуры
- Если инцидент был вызван человеческой ошибкой:
	- Устроить соответствующее обучение сотрудников
- Провести анализ первопричины для выявления и устранения уязвимостей.
- Провести оценку работы сотрудников: продолжительность рабочего времени, сверхурочные, отгулы за переработку и расходы.

**Составление отчета о последействиях инцидента, который должен включать как минимум следующую информацию:**

- Детали причин и воздействия инцидента, а также действий, предпринятых для смягчения киберинцидента, включая даты, тип и местоположение инцидента, а также его влияние на пользователей; время, затраченное на реагирование. Оценить выплаченный выкуп или иной ущерб, штрафы от государственных органов.
- Действия, предпринятые соответствующими группами реагирования, поставщиками услуг и заинтересованными сторонами бизнеса, которые позволили возобновить нормальную работу.
- Анализ ошибок реагирования и рекомендации по улучшению действий, процессов или технологий в организации, чтобы предотвратить повторное возникновение подобного киберинцидента.
- Мониторинг каких прекурсоров и индикаторов должен осуществляться для предотвращения подобного рода инцидентов?
- Сделать вывод о проанализированных артефактах форензики.

Необходимо определить действия по улучшению процессов управления DDoS-атаками, чтобы извлечь пользу из полученного опыта.

**Защита системы:**

Защита систем (hardening) может помочь защитить веб-сайты и сети от DDoS-атак и является критически важным для обеспечения доступности систем для легитимных пользователей. Вот некоторые шаги по защите веб-ресурсов:

- Используйте веб-сайты firewalls (WAF) для фильтрации трафика с известных вредоносных IP-адресов 
- Реализуйте ограничение скорости для ограничения объема трафика, который может быть отправлен на веб-сайт с одного источника или IP-адреса
- Разверните балансировщики нагрузки для распределения входящего трафика по нескольким серверам, чтобы предотвратить перегрузку одного сервера DDoS-атакой
- Обновляйте сетевые устройства до последней версии прошивки и патчей безопасности для устранения известных уязвимостей
- Просмотрите и обновите конфигурации межсетевого экрана и сетевой безопасности, чтобы ограничить доступ к системам и защититься от несанкционированного трафика
- Выполните сегментацию сети, чтобы отделить критически важные активы от публичных серверов
- Подпишитесь на услугу защиты от DDoS-атак у интернет-провайдеров или поставщиков облачных услуг

  
</details>


</details>
